{"ast":null,"code":"var _jsxFileName = \"D:\\\\digital-sinagae-project\\\\project\\\\frontend\\\\digital-signage\\\\src\\\\components\\\\Player.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from \"react\";\nimport { io } from \"socket.io-client\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API = \"http://localhost:8080\";\nconst socket = io(API);\nfunction Player({\n  screenId\n}) {\n  _s();\n  const [timeline, setTimeline] = useState([]);\n  const [index, setIndex] = useState(0);\n  const loadTimeline = async () => {\n    if (!screenId) return;\n    try {\n      const res = await fetch(`${API}/player/${screenId}`);\n      const data = await res.json();\n      setTimeline(Array.isArray(data) ? data : []);\n      setIndex(0);\n    } catch (err) {\n      console.error(\"Failed to load timeline\", err);\n      setTimeline([]);\n    }\n  };\n  useEffect(() => {\n    loadTimeline();\n    socket.emit(\"register-screen\", screenId);\n    socket.on(\"playlist-updated\", () => {\n      console.log(\"Playlist updated, reloading...\");\n      loadTimeline();\n    });\n    return () => socket.off(\"playlist-updated\");\n  }, [screenId]);\n\n  // Reset index if timeline changes\n  useEffect(() => {\n    setIndex(0);\n  }, [timeline]);\n\n  // Advance timeline\n  useEffect(() => {\n    if (!timeline.length) return;\n    const current = timeline[index];\n    const timer = setTimeout(() => {\n      setIndex((index + 1) % timeline.length);\n    }, current.duration * 1000);\n    return () => clearTimeout(timer);\n  }, [index, timeline]);\n  if (!screenId) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-screen h-screen bg-black text-white flex items-center justify-center\",\n      children: \"Select a screen\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this);\n  }\n  if (!timeline.length) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-screen h-screen bg-black text-white flex items-center justify-center\",\n      children: \"No content assigned\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 7\n    }, this);\n  }\n  const current = timeline[index];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"w-screen h-screen bg-black flex items-center justify-center\",\n    children: current.type === \"image\" ? /*#__PURE__*/_jsxDEV(\"img\", {\n      src: current.url,\n      className: \"max-w-full max-h-full\",\n      alt: \"\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"video\", {\n      src: current.url,\n      autoPlay: true,\n      muted: true,\n      className: \"max-w-full max-h-full\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 5\n  }, this);\n}\n_s(Player, \"AIHNCiifUxS3vOjwm/ldbPXilWE=\");\n_c = Player;\nexport default Player;\nvar _c;\n$RefreshReg$(_c, \"Player\");","map":{"version":3,"names":["useEffect","useState","io","jsxDEV","_jsxDEV","API","socket","Player","screenId","_s","timeline","setTimeline","index","setIndex","loadTimeline","res","fetch","data","json","Array","isArray","err","console","error","emit","on","log","off","length","current","timer","setTimeout","duration","clearTimeout","className","children","fileName","_jsxFileName","lineNumber","columnNumber","type","src","url","alt","autoPlay","muted","_c","$RefreshReg$"],"sources":["D:/digital-sinagae-project/project/frontend/digital-signage/src/components/Player.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport { io } from \"socket.io-client\";\n\nconst API = \"http://localhost:8080\";\nconst socket = io(API);\n\nfunction Player({ screenId }) {\n  const [timeline, setTimeline] = useState([]);\n  const [index, setIndex] = useState(0);\n\n  const loadTimeline = async () => {\n    if (!screenId) return;\n\n    try {\n      const res = await fetch(`${API}/player/${screenId}`);\n      const data = await res.json();\n      setTimeline(Array.isArray(data) ? data : []);\n      setIndex(0);\n    } catch (err) {\n      console.error(\"Failed to load timeline\", err);\n      setTimeline([]);\n    }\n  };\n\n  useEffect(() => {\n    loadTimeline();\n\n    socket.emit(\"register-screen\", screenId);\n\n    socket.on(\"playlist-updated\", () => {\n      console.log(\"Playlist updated, reloading...\");\n      loadTimeline();\n    });\n\n    return () => socket.off(\"playlist-updated\");\n  }, [screenId]);\n\n  // Reset index if timeline changes\n  useEffect(() => {\n    setIndex(0);\n  }, [timeline]);\n\n  // Advance timeline\n  useEffect(() => {\n    if (!timeline.length) return;\n\n    const current = timeline[index];\n    const timer = setTimeout(() => {\n      setIndex((index + 1) % timeline.length);\n    }, current.duration * 1000);\n\n    return () => clearTimeout(timer);\n  }, [index, timeline]);\n\n  if (!screenId) {\n    return (\n      <div className=\"w-screen h-screen bg-black text-white flex items-center justify-center\">\n        Select a screen\n      </div>\n    );\n  }\n\n  if (!timeline.length) {\n    return (\n      <div className=\"w-screen h-screen bg-black text-white flex items-center justify-center\">\n        No content assigned\n      </div>\n    );\n  }\n\n  const current = timeline[index];\n\n  return (\n    <div className=\"w-screen h-screen bg-black flex items-center justify-center\">\n      {current.type === \"image\" ? (\n        <img src={current.url} className=\"max-w-full max-h-full\" alt=\"\" />\n      ) : (\n        <video src={current.url} autoPlay muted className=\"max-w-full max-h-full\" />\n      )}\n    </div>\n  );\n}\n\nexport default Player;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}