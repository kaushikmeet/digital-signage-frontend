{"ast":null,"code":"var _jsxFileName = \"D:\\\\digital-sinagae-project\\\\project\\\\frontend\\\\digital-signage\\\\src\\\\components\\\\Player.js\",\n  _s = $RefreshSig$();\n// eslint-disable-next-line\nimport { useEffect, useState } from \"react\";\nimport { io } from \"socket.io-client\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API = \"http://localhost:8080\";\nconst socket = io(API);\nfunction Player({\n  screenId\n}) {\n  _s();\n  const [timeline, setTimeline] = useState([]);\n  const [index, setIndex] = useState(0);\n  const loadTimeline = async () => {\n    const res = await fetch(`${API}/player/${screenId}`);\n    setTimeline(await res.json());\n    setIndex(0);\n  };\n  useEffect(() => {\n    loadTimeline();\n    socket.emit(\"register-screen\", screenId);\n    socket.on(\"playlist-updated\", () => {\n      console.log(\"Playlist updated, reloading...\");\n      loadTimeline();\n    });\n    return () => socket.off(\"playlist-updated\");\n  }, [screenId]);\n  useEffect(() => {\n    if (!timeline.length) return;\n    const current = timeline[index];\n    const timer = setTimeout(() => {\n      setIndex((index + 1) % timeline.length);\n    }, current.duration * 1000);\n    return () => clearTimeout(timer);\n  }, [index, timeline]);\n  if (!timeline.length) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-screen h-screen bg-black text-white flex items-center justify-center\",\n      children: \"No content assigned\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 7\n    }, this);\n  }\n  const current = timeline[index];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"w-screen h-screen bg-black flex items-center justify-center\",\n    children: current.type === \"image\" ? /*#__PURE__*/_jsxDEV(\"img\", {\n      src: current.url,\n      className: \"max-w-full max-h-full\",\n      alt: \"\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 55,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"video\", {\n      src: current.url,\n      autoPlay: true,\n      muted: true,\n      className: \"max-w-full max-h-full\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 53,\n    columnNumber: 5\n  }, this);\n}\n_s(Player, \"no2VAy11UEr7kodvwbz1YirbIDE=\");\n_c = Player;\nexport default Player;\nvar _c;\n$RefreshReg$(_c, \"Player\");","map":{"version":3,"names":["useEffect","useState","io","jsxDEV","_jsxDEV","API","socket","Player","screenId","_s","timeline","setTimeline","index","setIndex","loadTimeline","res","fetch","json","emit","on","console","log","off","length","current","timer","setTimeout","duration","clearTimeout","className","children","fileName","_jsxFileName","lineNumber","columnNumber","type","src","url","alt","autoPlay","muted","_c","$RefreshReg$"],"sources":["D:/digital-sinagae-project/project/frontend/digital-signage/src/components/Player.js"],"sourcesContent":["// eslint-disable-next-line\nimport { useEffect, useState } from \"react\";\nimport { io } from \"socket.io-client\";\n\nconst API = \"http://localhost:8080\";\nconst socket = io(API);\n\nfunction Player({ screenId }) {\n  const [timeline, setTimeline] = useState([]);\n  const [index, setIndex] = useState(0);\n\n  const loadTimeline = async () => {\n    const res = await fetch(`${API}/player/${screenId}`);\n    setTimeline(await res.json());\n    setIndex(0);\n  };\n\n  useEffect(() => {\n    loadTimeline();\n\n    socket.emit(\"register-screen\", screenId);\n\n    socket.on(\"playlist-updated\", () => {\n      console.log(\"Playlist updated, reloading...\");\n      loadTimeline();\n    });\n\n    return () => socket.off(\"playlist-updated\");\n  }, [screenId]);\n\n  useEffect(() => {\n    if (!timeline.length) return;\n\n    const current = timeline[index];\n    const timer = setTimeout(() => {\n      setIndex((index + 1) % timeline.length);\n    }, current.duration * 1000);\n\n    return () => clearTimeout(timer);\n  }, [index, timeline]);\n\n  if (!timeline.length) {\n    return (\n      <div className=\"w-screen h-screen bg-black text-white flex items-center justify-center\">\n        No content assigned\n      </div>\n    );\n  }\n\n  const current = timeline[index];\n\n  return (\n    <div className=\"w-screen h-screen bg-black flex items-center justify-center\">\n      {current.type === \"image\" ? (\n        <img src={current.url} className=\"max-w-full max-h-full\" alt=\"\" />\n      ) : (\n        <video src={current.url} autoPlay muted className=\"max-w-full max-h-full\" />\n      )}\n    </div>\n  );\n}\n\nexport default Player;\n"],"mappings":";;AAAA;AACA,SAASA,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC3C,SAASC,EAAE,QAAQ,kBAAkB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEtC,MAAMC,GAAG,GAAG,uBAAuB;AACnC,MAAMC,MAAM,GAAGJ,EAAE,CAACG,GAAG,CAAC;AAEtB,SAASE,MAAMA,CAAC;EAAEC;AAAS,CAAC,EAAE;EAAAC,EAAA;EAC5B,MAAM,CAACC,QAAQ,EAAEC,WAAW,CAAC,GAAGV,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAACW,KAAK,EAAEC,QAAQ,CAAC,GAAGZ,QAAQ,CAAC,CAAC,CAAC;EAErC,MAAMa,YAAY,GAAG,MAAAA,CAAA,KAAY;IAC/B,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,GAAGX,GAAG,WAAWG,QAAQ,EAAE,CAAC;IACpDG,WAAW,CAAC,MAAMI,GAAG,CAACE,IAAI,CAAC,CAAC,CAAC;IAC7BJ,QAAQ,CAAC,CAAC,CAAC;EACb,CAAC;EAEDb,SAAS,CAAC,MAAM;IACdc,YAAY,CAAC,CAAC;IAEdR,MAAM,CAACY,IAAI,CAAC,iBAAiB,EAAEV,QAAQ,CAAC;IAExCF,MAAM,CAACa,EAAE,CAAC,kBAAkB,EAAE,MAAM;MAClCC,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC;MAC7CP,YAAY,CAAC,CAAC;IAChB,CAAC,CAAC;IAEF,OAAO,MAAMR,MAAM,CAACgB,GAAG,CAAC,kBAAkB,CAAC;EAC7C,CAAC,EAAE,CAACd,QAAQ,CAAC,CAAC;EAEdR,SAAS,CAAC,MAAM;IACd,IAAI,CAACU,QAAQ,CAACa,MAAM,EAAE;IAEtB,MAAMC,OAAO,GAAGd,QAAQ,CAACE,KAAK,CAAC;IAC/B,MAAMa,KAAK,GAAGC,UAAU,CAAC,MAAM;MAC7Bb,QAAQ,CAAC,CAACD,KAAK,GAAG,CAAC,IAAIF,QAAQ,CAACa,MAAM,CAAC;IACzC,CAAC,EAAEC,OAAO,CAACG,QAAQ,GAAG,IAAI,CAAC;IAE3B,OAAO,MAAMC,YAAY,CAACH,KAAK,CAAC;EAClC,CAAC,EAAE,CAACb,KAAK,EAAEF,QAAQ,CAAC,CAAC;EAErB,IAAI,CAACA,QAAQ,CAACa,MAAM,EAAE;IACpB,oBACEnB,OAAA;MAAKyB,SAAS,EAAC,wEAAwE;MAAAC,QAAA,EAAC;IAExF;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC;EAEV;EAEA,MAAMV,OAAO,GAAGd,QAAQ,CAACE,KAAK,CAAC;EAE/B,oBACER,OAAA;IAAKyB,SAAS,EAAC,6DAA6D;IAAAC,QAAA,EACzEN,OAAO,CAACW,IAAI,KAAK,OAAO,gBACvB/B,OAAA;MAAKgC,GAAG,EAAEZ,OAAO,CAACa,GAAI;MAACR,SAAS,EAAC,uBAAuB;MAACS,GAAG,EAAC;IAAE;MAAAP,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC,gBAElE9B,OAAA;MAAOgC,GAAG,EAAEZ,OAAO,CAACa,GAAI;MAACE,QAAQ;MAACC,KAAK;MAACX,SAAS,EAAC;IAAuB;MAAAE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE;EAC5E;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACE,CAAC;AAEV;AAACzB,EAAA,CArDQF,MAAM;AAAAkC,EAAA,GAANlC,MAAM;AAuDf,eAAeA,MAAM;AAAC,IAAAkC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}