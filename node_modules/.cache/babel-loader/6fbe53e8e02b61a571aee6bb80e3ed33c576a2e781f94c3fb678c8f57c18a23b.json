{"ast":null,"code":"var _jsxFileName = \"D:\\\\digital-sinagae-project\\\\project\\\\frontend\\\\digital-signage\\\\src\\\\components\\\\ZonePlayer.jsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useRef, useState } from \"react\";\nimport api from \"../api/services\";\nimport usePlaylistPlayer from \"../hooks/usePlaylistPlayer\";\nimport MediaPlayer from \"./MediaPlayer\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function ZonePlayer({\n  screenId,\n  zoneId,\n  playlistId,\n  fallbackMediaId\n}) {\n  _s();\n  const [items, setItems] = useState([]);\n  const [fallbackMedia, setFallbackMedia] = useState(null);\n  const loggedRef = useRef(null);\n\n  /* ðŸŽž LOAD PLAYLIST ITEMS */\n  useEffect(() => {\n    if (!playlistId) {\n      setItems([]);\n      return;\n    }\n    api.get(`/playlists/${playlistId}/active-items`).then(res => setItems(res.data || [])).catch(() => setItems([]));\n  }, [playlistId]);\n\n  /* ðŸ›Ÿ LOAD FALLBACK MEDIA */\n  useEffect(() => {\n    if (!fallbackMediaId) {\n      setFallbackMedia(null);\n      return;\n    }\n    api.get(`/media/${fallbackMediaId}`).then(res => setFallbackMedia(res.data)).catch(() => setFallbackMedia(null));\n  }, [fallbackMediaId]);\n\n  /* ðŸŽ¯ PLAYLIST PLAYER */\n  const itemsToPlay = playlistItems.length ? playlistItems : fallbackMedia ? [fallbackMedia] : [];\n  const {\n    current\n  } = usePlaylistPlayer(itemsToPlay);\n\n  /* ðŸ“Š ZONE-LEVEL ANALYTICS */\n  useEffect(() => {\n    var _current$mediaId;\n    if (!(current !== null && current !== void 0 && (_current$mediaId = current.mediaId) !== null && _current$mediaId !== void 0 && _current$mediaId._id)) return;\n    if (loggedRef.current === current.mediaId._id) return;\n    loggedRef.current = current.mediaId._id;\n    api.post(\"/analytics/log\", {\n      screenId,\n      mediaId: current.mediaId._id,\n      zoneId\n    }).catch(() => {});\n  }, [current, screenId, zoneId]);\n  if (!(current !== null && current !== void 0 && current.mediaId)) return null;\n  return /*#__PURE__*/_jsxDEV(MediaPlayer, {\n    media: current.mediaId\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 10\n  }, this);\n}\n_s(ZonePlayer, \"MaagbnGfjHkmCxaXwIhjwb2dTjk=\", false, function () {\n  return [usePlaylistPlayer];\n});\n_c = ZonePlayer;\nvar _c;\n$RefreshReg$(_c, \"ZonePlayer\");","map":{"version":3,"names":["useEffect","useRef","useState","api","usePlaylistPlayer","MediaPlayer","jsxDEV","_jsxDEV","ZonePlayer","screenId","zoneId","playlistId","fallbackMediaId","_s","items","setItems","fallbackMedia","setFallbackMedia","loggedRef","get","then","res","data","catch","itemsToPlay","playlistItems","length","current","_current$mediaId","mediaId","_id","post","media","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["D:/digital-sinagae-project/project/frontend/digital-signage/src/components/ZonePlayer.jsx"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\";\nimport api from \"../api/services\";\nimport usePlaylistPlayer from \"../hooks/usePlaylistPlayer\";\nimport MediaPlayer from \"./MediaPlayer\";\n\nexport default function ZonePlayer({\n  screenId,\n  zoneId,\n  playlistId,\n  fallbackMediaId\n}) {\n  const [items, setItems] = useState([]);\n  const [fallbackMedia, setFallbackMedia] = useState(null);\n  const loggedRef = useRef(null);\n\n  /* ðŸŽž LOAD PLAYLIST ITEMS */\n  useEffect(() => {\n    if (!playlistId) {\n      setItems([]);\n      return;\n    }\n\n    api\n      .get(`/playlists/${playlistId}/active-items`)\n      .then(res => setItems(res.data || []))\n      .catch(() => setItems([]));\n  }, [playlistId]);\n\n  /* ðŸ›Ÿ LOAD FALLBACK MEDIA */\n  useEffect(() => {\n    if (!fallbackMediaId) {\n      setFallbackMedia(null);\n      return;\n    }\n\n    api\n      .get(`/media/${fallbackMediaId}`)\n      .then(res => setFallbackMedia(res.data))\n      .catch(() => setFallbackMedia(null));\n  }, [fallbackMediaId]);\n\n  /* ðŸŽ¯ PLAYLIST PLAYER */\n  const itemsToPlay =\n  playlistItems.length\n    ? playlistItems\n    : fallbackMedia\n      ? [fallbackMedia]\n      : [];\n\n  const { current } = usePlaylistPlayer(itemsToPlay);\n\n  /* ðŸ“Š ZONE-LEVEL ANALYTICS */\n  useEffect(() => {\n    if (!current?.mediaId?._id) return;\n\n    if (loggedRef.current === current.mediaId._id) return;\n    loggedRef.current = current.mediaId._id;\n\n    api.post(\"/analytics/log\", {\n      screenId,\n      mediaId: current.mediaId._id,\n      zoneId\n    }).catch(() => {});\n  }, [current, screenId, zoneId]);\n\n  if (!current?.mediaId) return null;\n\n  return <MediaPlayer media={current.mediaId} />;\n}\n"],"mappings":";;AAAA,SAASA,SAAS,EAAEC,MAAM,EAAEC,QAAQ,QAAQ,OAAO;AACnD,OAAOC,GAAG,MAAM,iBAAiB;AACjC,OAAOC,iBAAiB,MAAM,4BAA4B;AAC1D,OAAOC,WAAW,MAAM,eAAe;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAExC,eAAe,SAASC,UAAUA,CAAC;EACjCC,QAAQ;EACRC,MAAM;EACNC,UAAU;EACVC;AACF,CAAC,EAAE;EAAAC,EAAA;EACD,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGb,QAAQ,CAAC,EAAE,CAAC;EACtC,MAAM,CAACc,aAAa,EAAEC,gBAAgB,CAAC,GAAGf,QAAQ,CAAC,IAAI,CAAC;EACxD,MAAMgB,SAAS,GAAGjB,MAAM,CAAC,IAAI,CAAC;;EAE9B;EACAD,SAAS,CAAC,MAAM;IACd,IAAI,CAACW,UAAU,EAAE;MACfI,QAAQ,CAAC,EAAE,CAAC;MACZ;IACF;IAEAZ,GAAG,CACAgB,GAAG,CAAC,cAAcR,UAAU,eAAe,CAAC,CAC5CS,IAAI,CAACC,GAAG,IAAIN,QAAQ,CAACM,GAAG,CAACC,IAAI,IAAI,EAAE,CAAC,CAAC,CACrCC,KAAK,CAAC,MAAMR,QAAQ,CAAC,EAAE,CAAC,CAAC;EAC9B,CAAC,EAAE,CAACJ,UAAU,CAAC,CAAC;;EAEhB;EACAX,SAAS,CAAC,MAAM;IACd,IAAI,CAACY,eAAe,EAAE;MACpBK,gBAAgB,CAAC,IAAI,CAAC;MACtB;IACF;IAEAd,GAAG,CACAgB,GAAG,CAAC,UAAUP,eAAe,EAAE,CAAC,CAChCQ,IAAI,CAACC,GAAG,IAAIJ,gBAAgB,CAACI,GAAG,CAACC,IAAI,CAAC,CAAC,CACvCC,KAAK,CAAC,MAAMN,gBAAgB,CAAC,IAAI,CAAC,CAAC;EACxC,CAAC,EAAE,CAACL,eAAe,CAAC,CAAC;;EAErB;EACA,MAAMY,WAAW,GACjBC,aAAa,CAACC,MAAM,GAChBD,aAAa,GACbT,aAAa,GACX,CAACA,aAAa,CAAC,GACf,EAAE;EAER,MAAM;IAAEW;EAAQ,CAAC,GAAGvB,iBAAiB,CAACoB,WAAW,CAAC;;EAElD;EACAxB,SAAS,CAAC,MAAM;IAAA,IAAA4B,gBAAA;IACd,IAAI,EAACD,OAAO,aAAPA,OAAO,gBAAAC,gBAAA,GAAPD,OAAO,CAAEE,OAAO,cAAAD,gBAAA,eAAhBA,gBAAA,CAAkBE,GAAG,GAAE;IAE5B,IAAIZ,SAAS,CAACS,OAAO,KAAKA,OAAO,CAACE,OAAO,CAACC,GAAG,EAAE;IAC/CZ,SAAS,CAACS,OAAO,GAAGA,OAAO,CAACE,OAAO,CAACC,GAAG;IAEvC3B,GAAG,CAAC4B,IAAI,CAAC,gBAAgB,EAAE;MACzBtB,QAAQ;MACRoB,OAAO,EAAEF,OAAO,CAACE,OAAO,CAACC,GAAG;MAC5BpB;IACF,CAAC,CAAC,CAACa,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC;EACpB,CAAC,EAAE,CAACI,OAAO,EAAElB,QAAQ,EAAEC,MAAM,CAAC,CAAC;EAE/B,IAAI,EAACiB,OAAO,aAAPA,OAAO,eAAPA,OAAO,CAAEE,OAAO,GAAE,OAAO,IAAI;EAElC,oBAAOtB,OAAA,CAACF,WAAW;IAAC2B,KAAK,EAAEL,OAAO,CAACE;EAAQ;IAAAI,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE,CAAC;AAChD;AAACvB,EAAA,CA/DuBL,UAAU;EAAA,QA4CZJ,iBAAiB;AAAA;AAAAiC,EAAA,GA5Cf7B,UAAU;AAAA,IAAA6B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}