{"ast":null,"code":"var _jsxFileName = \"D:\\\\digital-sinagae-project\\\\project\\\\frontend\\\\digital-signage\\\\src\\\\components\\\\Player.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useRef, useState } from \"react\";\nimport api from \"../api/services\";\nimport socket from \"../utils/socket\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Player({\n  screenId\n}) {\n  _s();\n  const [timeline, setTimeline] = useState([]);\n  const [index, setIndex] = useState(0);\n  const timerRef = useRef(null);\n  const loadTimeline = async () => {\n    try {\n      const res = await api.get(`/player/${screenId}`);\n      setTimeline(res.data);\n      setIndex(0);\n    } catch (err) {\n      console.error(\"Failed to load playlist\", err);\n    }\n  };\n\n  /* ðŸ”Œ SOCKET SETUP */\n  useEffect(() => {\n    if (!screenId) return;\n    socket.connect();\n    socket.emit(\"join-screen\", screenId);\n    socket.on(\"playlist-updated\", () => {\n      console.log(\"ðŸ”„ Playlist updated\");\n      loadTimeline();\n    });\n    return () => {\n      socket.off(\"playlist-updated\");\n      socket.disconnect();\n    };\n  }, [screenId]);\n\n  /* â±ï¸ PLAYBACK LOOP */\n  useEffect(() => {\n    if (!timeline.length) return;\n    const current = timeline[index];\n    clearTimeout(timerRef.current);\n\n    // Images use duration, videos play fully\n    if (current.type === \"image\") {\n      timerRef.current = setTimeout(() => {\n        setIndex(i => (i + 1) % timeline.length);\n      }, current.duration * 1000);\n    }\n    return () => clearTimeout(timerRef.current);\n  }, [index, timeline]);\n\n  /* ðŸŽ¥ Video auto-next */\n  const handleVideoEnd = () => {\n    setIndex(i => (i + 1) % timeline.length);\n  };\n  if (!timeline.length) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-screen h-screen bg-black text-white flex items-center justify-center\",\n      children: \"No content assigned\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }, this);\n  }\n  const current = timeline[index];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"w-screen h-screen bg-black flex items-center justify-center\",\n    children: current.type === \"image\" ? /*#__PURE__*/_jsxDEV(\"img\", {\n      src: current.url,\n      alt: \"\",\n      className: \"max-w-full max-h-full object-contain\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"video\", {\n      src: current.url,\n      autoPlay: true,\n      muted: true,\n      onEnded: handleVideoEnd,\n      className: \"max-w-full max-h-full object-contain\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 5\n  }, this);\n}\n_s(Player, \"1FeJ4ALWI76PdPEYVEzJR+Sb6rQ=\");\n_c = Player;\nexport default Player;\nvar _c;\n$RefreshReg$(_c, \"Player\");","map":{"version":3,"names":["useEffect","useRef","useState","api","socket","jsxDEV","_jsxDEV","Player","screenId","_s","timeline","setTimeline","index","setIndex","timerRef","loadTimeline","res","get","data","err","console","error","connect","emit","on","log","off","disconnect","length","current","clearTimeout","type","setTimeout","i","duration","handleVideoEnd","className","children","fileName","_jsxFileName","lineNumber","columnNumber","src","url","alt","autoPlay","muted","onEnded","_c","$RefreshReg$"],"sources":["D:/digital-sinagae-project/project/frontend/digital-signage/src/components/Player.js"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\";\nimport api from \"../api/services\";\nimport socket from \"../utils/socket\";\n\nfunction Player({ screenId }) {\n  const [timeline, setTimeline] = useState([]);\n  const [index, setIndex] = useState(0);\n  const timerRef = useRef(null);\n\n  const loadTimeline = async () => {\n    try {\n      const res = await api.get(`/player/${screenId}`);\n      setTimeline(res.data);\n      setIndex(0);\n    } catch (err) {\n      console.error(\"Failed to load playlist\", err);\n    }\n  };\n\n  /* ðŸ”Œ SOCKET SETUP */\n  useEffect(() => {\n    if (!screenId) return;\n\n    socket.connect();\n    socket.emit(\"join-screen\", screenId);\n\n    socket.on(\"playlist-updated\", () => {\n      console.log(\"ðŸ”„ Playlist updated\");\n      loadTimeline();\n    });\n\n    return () => {\n      socket.off(\"playlist-updated\");\n      socket.disconnect();\n    };\n  }, [screenId]);\n\n  /* â±ï¸ PLAYBACK LOOP */\n  useEffect(() => {\n    if (!timeline.length) return;\n\n    const current = timeline[index];\n\n    clearTimeout(timerRef.current);\n\n    // Images use duration, videos play fully\n    if (current.type === \"image\") {\n      timerRef.current = setTimeout(() => {\n        setIndex((i) => (i + 1) % timeline.length);\n      }, current.duration * 1000);\n    }\n\n    return () => clearTimeout(timerRef.current);\n  }, [index, timeline]);\n\n  /* ðŸŽ¥ Video auto-next */\n  const handleVideoEnd = () => {\n    setIndex((i) => (i + 1) % timeline.length);\n  };\n\n  if (!timeline.length) {\n    return (\n      <div className=\"w-screen h-screen bg-black text-white flex items-center justify-center\">\n        No content assigned\n      </div>\n    );\n  }\n\n  const current = timeline[index];\n\n  return (\n    <div className=\"w-screen h-screen bg-black flex items-center justify-center\">\n      {current.type === \"image\" ? (\n        <img\n          src={current.url}\n          alt=\"\"\n          className=\"max-w-full max-h-full object-contain\"\n        />\n      ) : (\n        <video\n          src={current.url}\n          autoPlay\n          muted\n          onEnded={handleVideoEnd}\n          className=\"max-w-full max-h-full object-contain\"\n        />\n      )}\n    </div>\n  );\n}\n\nexport default Player;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}